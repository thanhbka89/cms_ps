webpackJsonp([2],{1424:function(t,e,a){a(1480);var s=a(1)(a(1445),a(1499),"data-v-ce72b55c",null);t.exports=s.exports},1445:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a(5),n=a(1485),o=a.n(n),r=a(20),i=a.n(r);e.default={name:"User",data:function(){return{showModal:!1,item:{id:"",role:3,status:1}}},computed:{is_admin:function(){return this.$store.getters.isAdmin}},created:function(){},methods:{openModal:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.item;this.item=t,this.showModal=!0},closeModal:function(){this.showModal=!1},modify:function(){this.item.id?this.update():this.insert()},insert:function(){var t=this;s.a.request("post","/user/register",this.item).then(function(e){e.data.success?(t.closeModal(),t.showToast()):t.showToast("warning",e.data.message.code)}).catch(function(t){console.error(t)})},update:function(){var t=this;s.a.request("put","/user/action/"+this.item.id,this.item).then(function(e){e.data.success?(t.closeModal(),t.showToast()):t.showToast("error",e.data.data.sqlMessage)}).catch(function(t){console.error(t)})},showToast:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"success",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.$swal({type:t,title:e||(this.item.id?"Cập nhật":"Thêm mới")+" thành công",toast:!0,position:"top-end",showConfirmButton:!1,timer:5e3})}},components:{Index:o.a,UserCreate:i.a}}},1450:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a(10),n=a.n(s),o=a(9),r=a.n(o),i=a(5),l=a(193),c=a.n(l),d=a(28);e.default={name:"UserIndex",components:{DatePicker:c.a},data:function(){return{searchKey:"",page:1,limit:10,totalPage:10,items:[],dateFrom:"",dateTo:(new Date).setDate((new Date).getDate()+1)}},props:{openModal:Function},computed:{filteredResources:function(){return this.items}},created:function(){this.fetchItems(),this.paginateCallback()},methods:{paginateCallback:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return r()(n.a.mark(function a(){var s,o;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return s=t.build_query(),a.prev=1,a.next=4,i.a.request("get","/user/p/"+e+s);case 4:o=a.sent,t.items=o.data,a.next=11;break;case 8:a.prev=8,a.t0=a.catch(1),console.error(a.t0);case 11:case"end":return a.stop()}},a,t,[[1,8]])}))()},fetchItems:function(){var t=this;return r()(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.count();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}},e,t,[[0,5]])}))()},addItem:function(){this.openModal({role:3,status:1})},editItem:function(t){this.openModal(t)},deleteItem:function(t){var e=this;i.a.request("delete","/user/action/"+t).then(function(t){t.data.success?e.showToast():e.showToast("error",t.data.data.sqlMessage)}).catch(function(t){console.error(t)})},search:function(){var t=this;return r()(n.a.mark(function e(){var a;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.build_query(),e.prev=1,e.next=4,t.paginateCallback();case 4:return e.next=6,t.count(a);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error(e.t0);case 11:case"end":return e.stop()}},e,t,[[1,8]])}))()},count:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return r()(n.a.mark(function a(){var s,o;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e=e||"",a.prev=1,a.next=4,i.a.request("get","/user/count"+e);case 4:s=a.sent,s.data.success&&(o=s.data.data,t.totalPage=o>t.limit?Math.ceil(o/t.limit):1),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(1),console.error(a.t0);case 11:case"end":return a.stop()}},a,t,[[1,8]])}))()},build_query:function(){var t="?";return this.searchKey&&(t=t.concat("username="+this.searchKey+"&phone=[or]"+this.searchKey+"&fullname=[or]"+this.searchKey)),this.limit&&(t=t.concat("&limit="+this.limit)),this.dateFrom&&(t=t.concat("&from="+a.i(d.a)({date:this.dateFrom}))),this.dateTo&&(t=t.concat("&to="+a.i(d.a)({date:this.dateTo}))),t},showAlertConfirm:function(t){var e=this;this.$swal({title:"Bạn có chắc?",text:"Bạn có muốn thực hiện khóa user?",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Đồng ý"}).then(function(a){a.value&&e.deleteItem(t)})},showAlert:function(){this.$swal("Chức năng đang hoàn thiện")},showToast:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"success",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.$swal({type:t,title:e||"Cập nhật thành công",toast:!0,position:"top-end",showConfirmButton:!1,timer:5e3})}}}},1465:function(t,e,a){e=t.exports=a(1415)(),e.push([t.i,".z-header[data-v-8989bf98]{color:#566787}.table-wrapper[data-v-8989bf98]{padding:20px 25px;margin:30px 0;border-radius:3px;box-shadow:0 1px 1px rgba(0,0,0,.05)}.table-title[data-v-8989bf98]{padding-bottom:15px;background:#435d7d;color:#fff;padding:16px 30px;margin:-20px -25px 10px;border-radius:3px 3px 0 0}.table-title .btn[data-v-8989bf98]{color:#fff;float:right;font-size:13px;min-width:50px;border-radius:2px;border:none;outline:none!important;margin-left:10px;margin-top:15px}","",{version:3,sources:["C:/working/code/cms_ps/src/components/widgets/user/Index.vue"],names:[],mappings:"AACA,2BACI,aAAc,CACjB,AACD,gCACI,kBAAmB,AACnB,cAAe,AACf,kBAAmB,AACnB,oCAAsC,CACzC,AACD,8BACI,oBAAqB,AACrB,mBAAoB,AACpB,WAAY,AACZ,kBAAmB,AACnB,wBAAyB,AACzB,yBAA2B,CAC9B,AACD,mCACI,WAAY,AACZ,YAAa,AACb,eAAgB,AAChB,eAAgB,AAChB,kBAAmB,AACnB,YAAa,AACb,uBAAyB,AACzB,iBAAkB,AAClB,eAAiB,CACpB",file:"Index.vue",sourcesContent:["\n.z-header[data-v-8989bf98] {\r\n    color: #566787\n}\n.table-wrapper[data-v-8989bf98] {\r\n    padding: 20px 25px;\r\n    margin: 30px 0;\r\n    border-radius: 3px;\r\n    box-shadow: 0 1px 1px rgba(0,0,0,.05);\n}\n.table-title[data-v-8989bf98] {\r\n    padding-bottom: 15px;\r\n    background: #435d7d;\r\n    color: #fff;\r\n    padding: 16px 30px;\r\n    margin: -20px -25px 10px;\r\n    border-radius: 3px 3px 0 0;\n}\n.table-title .btn[data-v-8989bf98] {\r\n    color: #fff;\r\n    float: right;\r\n    font-size: 13px;\r\n    min-width: 50px;\r\n    border-radius: 2px;\r\n    border: none;\r\n    outline: none !important;\r\n    margin-left: 10px;\r\n    margin-top: 15px;\n}\r\n"],sourceRoot:""}])},1467:function(t,e,a){e=t.exports=a(1415)(),e.push([t.i,".z-label[data-v-ce72b55c]{margin-top:5px}","",{version:3,sources:["C:/working/code/cms_ps/src/components/views/User.vue"],names:[],mappings:"AACA,0BACE,cAAgB,CACjB",file:"User.vue",sourcesContent:["\n.z-label[data-v-ce72b55c] {\r\n  margin-top: 5px;\n}\r\n"],sourceRoot:""}])},1478:function(t,e,a){var s=a(1465);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);a(1416)("4c6c66be",s,!0)},1480:function(t,e,a){var s=a(1467);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);a(1416)("18dfa802",s,!0)},1485:function(t,e,a){a(1478);var s=a(1)(a(1450),a(1497),"data-v-8989bf98",null);t.exports=s.exports},1497:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table-wrapper"},[a("div",{staticClass:"table-title"},[a("div",{staticClass:"row"},[t._m(0),t._v(" "),a("div",{staticClass:"col-sm-6"},[a("a",{staticClass:"btn btn-success",attrs:{href:"#","data-toggle":"modal"},on:{click:t.addItem}},[a("span",[t._v("Add user")])])])])]),t._v(" "),a("div",{staticClass:"filters row"},[a("div",{staticClass:"form-group col-sm-3"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.searchKey,expression:"searchKey"}],staticClass:"form-control",attrs:{id:"search-element",type:"text",placeholder:"Tìm kiếm username, phone ...","aria-label":"Search",autocomplete:"off"},domProps:{value:t.searchKey},on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.search(e)},input:function(e){e.target.composing||(t.searchKey=e.target.value)}}})]),t._v(" "),a("div",{staticClass:"form-group col-sm-6"},[a("date-picker",{attrs:{format:"YYYY-MM-DD",lang:"en",confirm:"",placeholder:"Từ ngày"},on:{change:t.search},model:{value:t.dateFrom,callback:function(e){t.dateFrom=e},expression:"dateFrom"}}),t._v(" "),a("date-picker",{attrs:{format:"YYYY-MM-DD",lang:"en",confirm:"",placeholder:"Đến ngày"},on:{change:t.search},model:{value:t.dateTo,callback:function(e){t.dateTo=e},expression:"dateTo"}})],1)]),t._v(" "),a("table",{staticClass:"table table-striped table-hover"},[t._m(1),t._v(" "),a("tbody",t._l(t.filteredResources,function(e){return a("tr",{key:e.id},[a("td",{staticClass:"col-md-1"},[t._v(t._s(e.id))]),t._v(" "),a("td",{staticClass:"col-md-1"},[a("router-link",{attrs:{to:{name:"UserDetail",params:{id:e.id}}}},[t._v(t._s(e.username))])],1),t._v(" "),a("td",{staticClass:"col-md-3"},[t._v(t._s(e.fullname))]),t._v(" "),a("td",{staticClass:"col-md-1"},[t._v(t._s(e.phone))]),t._v(" "),a("td",{staticClass:"col-md-2"},[t._v(t._s(1===e.role?"Quản trị viên":2===e.role?"Nhân viên":"Khách hàng"))]),t._v(" "),a("td",{staticClass:"col-md-2"},[t._v(t._s(e.status?"Đang hoạt động":"Không hoạt động"))]),t._v(" "),a("td",{staticClass:"col-md-2"},[a("button",{staticClass:"btn btn-primary",on:{click:function(a){t.editItem(e)}}},[t._v("Edit")]),t._v(" "),a("button",{staticClass:"btn btn-danger",on:{click:function(a){t.showAlertConfirm(e.id)}}},[t._v("Khóa")]),t._v(" "),a("a",{staticClass:"icon",attrs:{href:"#"}},[a("i",{staticClass:"fa fa-pencil",on:{click:function(e){t.showAlert()}}})]),t._v(" "),a("a",{staticClass:"icon",attrs:{href:"#"}},[a("i",{staticClass:"fa fa-trash",on:{click:t.showAlert}})])])])}))]),t._v(" "),a("div",{staticClass:"clearfix"},[a("paginate",{attrs:{"page-count":t.totalPage,"margin-pages":2,"page-range":5,"click-handler":t.paginateCallback,"container-class":"pagination","page-class":"page-item","page-link-class":"page-link-item","prev-class":"prev-item","prev-link-class":"prev-link-item","next-class":"next-item","next-link-class":"next-link-item","break-view-class":"break-view","break-view-link-class":"break-view-link","first-last-button":!0},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}})],1)])},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-sm-6"},[a("h2",[t._v("Manage "),a("b",[t._v("Users")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",{staticClass:"z-header"},[a("tr",[a("th",[t._v("ID")]),t._v(" "),a("th",[t._v("Username")]),t._v(" "),a("th",[t._v("FullName")]),t._v(" "),a("th",[t._v("Phone")]),t._v(" "),a("th",[t._v("Role")]),t._v(" "),a("th",[t._v("Trạng thái")]),t._v(" "),a("th",[t._v("Actions")])])])}]}},1499:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"content"},[a("div",{staticClass:"row"},[t.showModal?a("user-create",[a("h3",{staticClass:"modal-title",attrs:{slot:"header"},slot:"header"},[t._v("\n          "+t._s(t.item.id?"Cập nhật":"Thêm mới")+"\n        ")]),t._v(" "),a("div",{staticClass:"form-horizontal box-body",attrs:{slot:"body"},slot:"body"},[a("div",{staticClass:"form-group"},[a("label",{staticClass:"col-sm-3 z-label"},[t._v("Username:")]),t._v(" "),a("div",{staticClass:"col-sm-9"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.item.username,expression:"item.username"}],staticClass:"form-control",attrs:{type:"text",placeholder:"username ...",disabled:t.item.id},domProps:{value:t.item.username},on:{input:function(e){e.target.composing||t.$set(t.item,"username",e.target.value)}}})])]),t._v(" "),t.is_admin?a("div",{staticClass:"form-group"},[a("label",{staticClass:"col-sm-3 z-label"},[t._v("Password:")]),t._v(" "),a("div",{staticClass:"col-sm-9"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.item.password,expression:"item.password"}],staticClass:"form-control",attrs:{type:"password",placeholder:"passwd ..."},domProps:{value:t.item.password},on:{input:function(e){e.target.composing||t.$set(t.item,"password",e.target.value)}}})])]):t._e(),t._v(" "),a("div",{staticClass:"form-group"},[a("label",{staticClass:"col-sm-3 z-label"},[t._v("Họ Tên:")]),t._v(" "),a("div",{staticClass:"col-sm-9"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.item.fullname,expression:"item.fullname"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Họ và tên ..."},domProps:{value:t.item.fullname},on:{input:function(e){e.target.composing||t.$set(t.item,"fullname",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"form-group"},[a("label",{staticClass:"col-sm-3 z-label"},[t._v("Bí danh:")]),t._v(" "),a("div",{staticClass:"col-sm-9"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.item.nickname,expression:"item.nickname"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Tên nick name ..."},domProps:{value:t.item.nickname},on:{input:function(e){e.target.composing||t.$set(t.item,"nickname",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"form-group"},[a("label",{staticClass:"col-sm-3 z-label"},[t._v("Điện thoại:")]),t._v(" "),a("div",{staticClass:"col-sm-9"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.item.phone,expression:"item.phone"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.item.phone},on:{input:function(e){e.target.composing||t.$set(t.item,"phone",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"form-group"},[a("label",{staticClass:"col-sm-3 z-label"},[t._v("Địa chỉ:")]),t._v(" "),a("div",{staticClass:"col-sm-9"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.item.address,expression:"item.address"}],staticClass:"form-control",domProps:{value:t.item.address},on:{input:function(e){e.target.composing||t.$set(t.item,"address",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"form-group"},[a("label",{staticClass:"col-sm-3 z-label"},[t._v("Vai trò:")]),t._v(" "),a("div",{staticClass:"col-sm-9"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.item.role,expression:"item.role"}],staticClass:"form-control",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.item,"role",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"2"}},[t._v("Nhân viên")]),t._v(" "),a("option",{attrs:{value:"3"}},[t._v("Khách hàng")])])])]),t._v(" "),a("div",{staticClass:"form-group"},[a("label",{staticClass:"col-sm-3 z-label"},[t._v("Trạng thái:")]),t._v(" "),a("div",{staticClass:"col-sm-9"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.item.status,expression:"item.status"}],staticClass:"form-control",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.item,"status",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"1"}},[t._v("Hoạt động")]),t._v(" "),a("option",{attrs:{value:"0"}},[t._v("Không hoạt động")])])])])]),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("button",{staticClass:"btn btn-outline-info",attrs:{type:"button"},on:{click:function(e){t.closeModal()}}},[t._v(" Close ")]),t._v(" "),a("button",{staticClass:"btn btn-success",attrs:{type:"button"},on:{click:function(e){t.modify()}}},[t._v("Save Changes")])])]):t._e(),t._v(" "),a("div",{staticClass:"col-xs-12"},[a("index",{attrs:{openModal:t.openModal}})],1)],1)])},staticRenderFns:[]}}});
//# sourceMappingURL=2.d3472ab1e6689a9afeb1.js.map