webpackJsonp([7],{1422:function(t,e,a){a(1475);var n=a(1)(a(1442),a(1493),"data-v-5bc6c2c2",null);t.exports=n.exports},1442:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(194),r=a.n(n),o=a(10),s=a.n(o),c=a(8),i=a.n(c),d=a(9),u=a.n(d),l=a(193),_=a.n(l),v=a(5),h=a(28),p=new Date;e.default={name:"ReportNXT",components:{DatePicker:_.a},data:function(){return{items:[],dateFrom:new Date(p.getFullYear(),p.getMonth(),1),dateTo:(new Date).setDate(p.getDate()+1),data:[{code:"",name:"",dauky_sl:"",receive_trongky_sl:"",receive_trongky_thanhtien:"",issue_trongky_sl:"",issue_trongky_thanhtien:"",sl_tinhtoan:""}],nhap_trong_ky:[],xuat_trong_ky:[],ton_dau_ky:[]}},computed:{filteredResources:function(){return this.data}},created:function(){var t=this;return u()(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.all([t.getItems(),t.search()]);case 2:case"end":return e.stop()}},e,t)}))()},methods:{getItems:function(){var t=this;return u()(s.a.mark(function e(){var a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.request("get","/item/cate_active/1,2,4");case 3:a=e.sent,t.items=a.data,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}},e,t,[[0,7]])}))()},search:function(){var t=this;return u()(s.a.mark(function e(){var a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.dateFrom&&t.dateTo){e.next=3;break}return t.showAlert("Vui lòng chọn ngày tháng!"),e.abrupt("return");case 3:return e.next=5,i.a.all([t.getNhapTrongKy(),t.getXuatTrongKy(),t.getTonkhoDauKy()]);case 5:t.data=[],a={},t.items.forEach(function(e,n){a={},a.id=n+1,a.id_item=e.id,a.code=e.code,a.name=e.name;var r=t.ton_dau_ky.find(function(t){return e.code===t.code&&e.id===t.id_item});r&&(a.dauky_sl=r.sl_thucte),r=t.nhap_trong_ky.find(function(t){return e.code===t.code}),r&&(a.receive_trongky_sl=r.quantity,a.receive_trongky_thanhtien=r.total_money),r=t.xuat_trong_ky.find(function(t){return e.code===t.code}),r&&(a.issue_trongky_sl=r.quantity,a.issue_trongky_thanhtien=r.total_money),a.sl_tinhtoan=t.getTonkhoCuoiKy(a),t.data.push(a)});case 8:case"end":return e.stop()}},e,t)}))()},getNhapTrongKy:function(){var t=this;return u()(s.a.mark(function e(){var a,n,o,c;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.nhap_trong_ky=[],a=t.build_query(),e.prev=2,e.next=5,v.a.request("get","/inventory/p/1?limit=1993&status=1"+a);case 5:n=e.sent,o=n.data.data,c=r()(o.reduce(function(t,e){var a=e.code;return t[a]=t[a]||{code:e.code,total_money:0,quantity:0},t[a].total_money+=e.gia_nhap,t[a].quantity+=e.quantity,t},{})),t.nhap_trong_ky=c,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.error(e.t0);case 14:case"end":return e.stop()}},e,t,[[2,11]])}))()},getXuatTrongKy:function(){var t=this;return u()(s.a.mark(function e(){var a,n,o,c;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.xuat_trong_ky=[],a=t.build_query(),e.prev=2,e.next=5,v.a.request("get","/trans/trans_detail/p/1?limit=21993"+a);case 5:n=e.sent,o=n.data.data,c=r()(o.reduce(function(t,e){var a=e.code_item;return t[a]=t[a]||{code:e.code_item,total_money:0,quantity:0},t[a].total_money+=(parseInt(e.quantity)||0)*(parseInt(e.price)||0),t[a].quantity+=parseInt(e.quantity)||0,t},{})),t.xuat_trong_ky=c,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.error(e.t0);case 14:case"end":return e.stop()}},e,t,[[2,11]])}))()},getTonkhoDauKy:function(){var t=this;return u()(s.a.mark(function e(){var n,r,o,c;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.ton_dau_ky=[],n=a.i(h.a)({date:t.dateFrom,format:"MM/YYYY"}),r=a.i(h.a)({date:t.dateTo,format:"MM/YYYY"}),n!==r){e.next=15;break}return e.prev=4,o=a.i(h.d)({date:t.dateFrom,format:"MM/YYYY"}),e.next=8,v.a.request("get","/kiemke/p/1?limit=1993&period="+o);case 8:c=e.sent,t.ton_dau_ky=c.data.data,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(4),console.error(e.t0);case 15:case"end":return e.stop()}},e,t,[[4,12]])}))()},getTonkhoCuoiKy:function(t){return(parseInt(t.dauky_sl)||0)+(parseInt(t.receive_trongky_sl)||0)-(parseInt(t.issue_trongky_sl)||0)},build_query:function(){var t="";return this.dateFrom&&(t=t.concat("&from="+a.i(h.a)({date:this.dateFrom}))),this.dateTo&&(t=t.concat("&to="+a.i(h.a)({date:this.dateTo}))),t},updateKiemKe:function(){var t=this;return u()(s.a.mark(function e(){var n,r,o,c;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.i(h.a)({date:t.dateFrom,format:"MM/YYYY"}),r=a.i(h.a)({date:t.dateTo,format:"MM/YYYY"}),n!==r){e.next=14;break}return e.prev=3,o={items:t.data,period:n},e.next=7,v.a.request("post","/kiemke/post/mass_save",o);case 7:c=e.sent,c.data.success?t.showToast():t.showToast("error",c.data.data.code),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),console.error(e.t0);case 14:case"end":return e.stop()}},e,t,[[3,11]])}))()},showAlert:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.$swal(t||"Cảnh báo!")},showToast:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"success",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.$swal({type:t,title:e||"Cập nhật thành công",toast:!0,position:"top-end",showConfirmButton:!1,timer:5e3})}}}},1462:function(t,e,a){e=t.exports=a(1415)(),e.push([t.i,"td[data-v-5bc6c2c2],thead th[data-v-5bc6c2c2]{text-align:center;vertical-align:middle!important}.z-label[data-v-5bc6c2c2]{margin-top:5px}.item-code[data-v-5bc6c2c2]{text-align:left}.table-bordered>thead>tr>th[data-v-5bc6c2c2]{border:1px solid #f39c12}","",{version:3,sources:["D:/Source/cms_ps/src/components/views/ReportNXT.vue"],names:[],mappings:"AACA,8CACG,kBAAmB,AACnB,+BAAiC,CACnC,AACD,0BACE,cAAgB,CACjB,AACD,4BACE,eAAiB,CAClB,AACD,6CACE,wBAA0B,CAC3B",file:"ReportNXT.vue",sourcesContent:["\nthead th[data-v-5bc6c2c2],td[data-v-5bc6c2c2] {\r\n   text-align: center;\r\n   vertical-align: middle!important;\n}\n.z-label[data-v-5bc6c2c2] {\r\n  margin-top: 5px;\n}\n.item-code[data-v-5bc6c2c2] {\r\n  text-align: left;\n}\n.table-bordered>thead>tr>th[data-v-5bc6c2c2] {\r\n  border: 1px solid #f39c12;\n}\r\n"],sourceRoot:""}])},1475:function(t,e,a){var n=a(1462);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a(1416)("273c93b1",n,!0)},1493:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"content"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-xs-12"},[a("div",{staticClass:"table-wrapper"},[t._m(0),t._v(" "),a("div",{staticClass:"filters row"},[a("div",{staticClass:"form-group col-sm-6"},[a("date-picker",{attrs:{format:"YYYY-MM-DD",lang:"en",confirm:"",placeholder:"Từ ngày"},on:{change:t.search},model:{value:t.dateFrom,callback:function(e){t.dateFrom=e},expression:"dateFrom"}}),t._v(" "),a("date-picker",{attrs:{format:"YYYY-MM-DD",lang:"en",confirm:"",placeholder:"Đến ngày"},on:{change:t.search},model:{value:t.dateTo,callback:function(e){t.dateTo=e},expression:"dateTo"}})],1),t._v(" "),a("div",{staticClass:"form-group col-sm-2"},[a("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:t.updateKiemKe}},[t._v("Cập nhật Kiểm kê")])])]),t._v(" "),a("table",{staticClass:"table table-bordered table-condensed"},[t._m(1),t._v(" "),a("tbody",t._l(t.filteredResources,function(e){return a("tr",{key:e.id},[a("td",{staticClass:"col-md-1"},[t._v(t._s(e.id))]),t._v(" "),a("td",{staticClass:"col-md-1 item-code"},[t._v(t._s(e.code))]),t._v(" "),a("td",{staticClass:"col-md-3 item-code"},[t._v(t._s(e.name))]),t._v(" "),a("td",{staticClass:"col-md-1"},[t._v(t._s(e.dauky_sl||0))]),t._v(" "),a("td",{staticClass:"col-md-1"},[t._v(t._s(e.receive_trongky_sl))]),t._v(" "),a("td",{staticClass:"col-md-1"},[t._v(t._s(t._f("toVnd")(e.receive_trongky_thanhtien)))]),t._v(" "),a("td",{staticClass:"col-md-1"},[t._v(t._s(e.issue_trongky_sl))]),t._v(" "),a("td",{staticClass:"col-md-1"},[t._v(t._s(t._f("toVnd")(e.issue_trongky_thanhtien)))]),t._v(" "),a("td",{staticClass:"col-md-1"},[t._v(t._s(e.sl_tinhtoan))])])}))])])])])])},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table-title"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-6"},[a("h2",[t._v("Báo cáo nhập xuất tồn kho")])])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",{staticClass:"z-header"},[a("tr",{staticStyle:{border:"1px solid #f39c12"}},[a("th",{attrs:{rowspan:"2"}},[t._v("STT")]),t._v(" "),a("th",{attrs:{rowspan:"2"}},[t._v("Mã")]),t._v(" "),a("th",{attrs:{rowspan:"2"}},[t._v("Tên hàng")]),t._v(" "),a("th",[t._v("Tồn kho đầu kỳ")]),t._v(" "),a("th",{attrs:{colspan:"2"}},[t._v("Nhập trong kỳ")]),t._v(" "),a("th",{attrs:{colspan:"2"}},[t._v("Xuất trong kỳ")]),t._v(" "),a("th",[t._v("Tồn kho cuối kỳ")])]),t._v(" "),a("tr",[a("th",[t._v("Số lượng")]),t._v(" "),a("th",[t._v("Số lượng")]),t._v(" "),a("th",[t._v("Thành tiền")]),t._v(" "),a("th",[t._v("Số lượng")]),t._v(" "),a("th",[t._v("Thành tiền")]),t._v(" "),a("th",[t._v("Số lượng")])])])}]}}});
//# sourceMappingURL=7.2b3ebe07fc139856029d.js.map